@model HomeViewModel;

@{
    ViewData["Title"] = "Doliprane";
}

@section Styles {
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true" />
}

@section Scripts {
    <script src="~/js/home.js" type="module" asp-append-version="true" defer></script>
}

<div style="display: none">
    <svg id="doliprane" viewBox="0 0 58 58">
        <path d="m28.29,28.29c-3.89,3.89-5.8,8.34-4.24,9.9h0l7.78,7.78c3.89,3.89,10.25,3.89,14.14,0h0c3.89-3.89,3.89-10.25,0-14.14l-7.78-7.78h0c-1.56-1.56-6.01.35-9.9,4.24Z" />
        <path d="m46.68,31.12L26.88,11.32c-4.29-4.29-11.27-4.29-15.56,0-4.29,4.29-4.29,11.27,0,15.56l19.8,19.8c2.14,2.14,4.96,3.22,7.78,3.22s5.63-1.07,7.78-3.22c4.29-4.29,4.29-11.27,0-15.56ZM12.74,12.74c1.75-1.75,4.06-2.63,6.36-2.63s4.61.88,6.36,2.63l10.37,10.37c-2.21.37-5.15,2.1-7.89,4.84-1.92,1.92-3.44,4.05-4.27,5.98-.29.69-.48,1.32-.58,1.9l-10.36-10.36c-3.51-3.51-3.51-9.22,0-12.73Zm32.53,32.53c-3.51,3.51-9.22,3.51-12.73,0l-8.52-8.52c-.02-.65.17-1.47.57-2.43.78-1.82,2.22-3.83,4.06-5.67,3.13-3.13,6.32-4.69,8.1-4.63l8.52,8.52c3.51,3.51,3.51,9.22,0,12.73Z" />
        <path d="m17.38,26.37c-.13,0-.26-.05-.35-.15l-2.52-2.52c-2.06-2.06-2.49-5.14-1.07-7.68.13-.24.44-.33.68-.19.24.13.33.44.19.68-1.19,2.14-.83,4.75.91,6.48l2.52,2.52c.2.2.2.51,0,.71-.1.1-.23.15-.35.15Z" />
        <path style="fill:#ff0000" d="m 37.727767,47.771454 c -0.946995,-0.129067 -2.426204,-0.63283 -3.214642,-1.094788 -1.09654,-0.64248 -1.765035,-1.256753 -6.176389,-5.675422 l -4.294749,-4.301872 0.07117,-0.536502 c 0.113751,-0.857496 0.656263,-2.20944 1.350379,-3.365153 2.549176,-4.244416 7.464223,-8.227347 10.693563,-8.665578 l 0.562327,-0.07631 4.556022,4.573159 c 4.356312,4.372698 5.038316,5.134864 5.622308,6.283154 1.328915,2.613018 1.214128,6.019964 -0.286149,8.493092 -0.968567,1.596632 -2.20333,2.73309 -3.811964,3.508478 -1.59642,0.769501 -3.436294,1.080655 -5.071876,0.857742 z" />
        <path style="fill:#ffff00" d="m 17.521442,30.164515 c -3.34069,-3.3539 -5.600172,-5.703556 -5.839927,-6.072993 -0.9493,-1.462767 -1.394482,-2.84072 -1.481382,-4.585261 -0.181108,-3.635808 1.844743,-6.965433 5.172432,-8.501248 2.921499,-1.3483472 6.311493,-1.0254323 8.958383,0.853333 0.285331,0.202529 2.957291,2.797806 5.937689,5.767284 l 5.418906,5.39905 -0.867374,0.282706 c -2.334732,0.760966 -4.907343,2.517776 -7.228998,4.93661 -2.135524,2.224912 -3.545311,4.360236 -4.236278,6.416453 -0.164206,0.488655 -0.317912,0.907818 -0.341569,0.931474 -0.02366,0.02366 -2.495003,-2.418678 -5.491882,-5.427408 z m 0.265422,-3.921479 c 0.337595,-0.337594 0.18742,-0.569906 -1.430644,-2.213122 -1.774392,-1.801975 -2.022025,-2.140901 -2.413014,-3.302589 -0.366797,-1.089809 -0.323871,-2.427456 0.110772,-3.451833 0.157385,-0.37093 0.308811,-0.795288 0.336501,-0.943018 0.06517,-0.347688 -0.214948,-0.635116 -0.577942,-0.593027 -0.219713,0.02548 -0.337552,0.161789 -0.61031,0.705991 -0.858808,1.713478 -0.845216,3.740468 0.03744,5.583623 0.337003,0.703727 0.589676,1.0077 2.150588,2.587218 1.815989,1.837636 2.036235,1.987133 2.396611,1.626757 z" />
    </svg>
</div>

<div class="overlay"></div>
<div class="container">
    <div class="title">
        Doliprane
        <svg>
            <use xlink:href="#doliprane"></use>
        </svg>
    </div>
    <div class="medication">
        <select id="person">
            @foreach (var person in Model.Persons) {
                @if (person.Key == Model.PersonId) {
                    <option value="@person.Key" selected>@person.Value</option>
                } else {
                    <option value="@person.Key"> @person.Value </option>
                }
            }
        </select>
        <select id="drug">
            @foreach (var drug in Model.Drugs) {
                <option value="@drug.Key">@drug.Value</option>
            }
        </select>
        <a href="#" id="custom-date-link">Personnaliser la date et l'heure</a>
        <div class="datetime" id="custom-date">
            <input type="date" id="date" />
            <input type="time" id="hour" />
        </div>
        <div class="action">
            <button id="add">Ajouter</button>
        </div>
    </div>
    @if (Model.Medications.Count > 0) {
        @if (Model.DosageParacetamol > 0) {
            <div class="dosage">
                Vous avez pris @(Model.DosageParacetamol)g de paracétamol en 24h
            </div>
        }
        <div class="next-medication">
            <div>
                <span>Depuis 4h</span><span class="next-medication-since">@(Model.Medication4.Ok ? "✅" : "❌")</span>
                @if (!Model.Medication4.Ok) {
                    <span>jusqu'à @Model.Medication4.NextHour</span>
                }
            </div>
            <div>
                <span>Depuis 6h</span><span class="next-medication-since">@(Model.Medication6.Ok ? "✅" : "❌")</span>
                @if (!Model.Medication6.Ok) {
                    <span>jusqu'à @Model.Medication6.NextHour</span>
                }
            </div>
        </div>
        <div class="history">
            <span>Historique des dernières 48h</span>
            @foreach (MedicationViewModel medication in Model.Medications) {
                <div class="history-date">
                    <span>@medication.Date</span>
                    @foreach (MedicationDetailViewModel detail in medication.Details) {
                        <div class="history-detail">
                            <span>@detail.Hour</span>
                            <span>@detail.Drug</span>
                        </div>
                    }
                </div>
            }
        </div>
    }
</div>
